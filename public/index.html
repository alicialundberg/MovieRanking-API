<!DOCTYPE html>
<html>
  <head>
    <title>Rate The Movie</title>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0,  minimum-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  </head>
  <body>
    <div class="navbar navbar-inverse">
      <div class="container">
        <a class="navbar-brand" href="#">Your Own Movie Database</a>
        <div class="nav pull-right">
          <form class="navbar-form navbar-left">
            <div class="form-group">
              <input type="text" id="search" class="form-control" placeholder="Search for a movie">
            </div>
            <button type="submit" id="submit" class="btn btn-default">Submit</button>
          </form>
        </div>
      </div>
    </div>
    <div class="container">
      <table id="showList" class="table">
          <thead>
            <tr>
              <th>Title</th>
              <th>Year</th>
              <th>Genre</th>
              <th>IMDB Rating</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody></tbody>
      </table>
    </div>
  </body>
  <script>
  function build_imdb_search_url(pattern) {
    var base_url = "http://www.theimdbapi.org/api/find/movie?title=";
    var url = base_url + pattern;
    return url;
  }
  $(document).ready(function() {
    $("#submit").click(function(e) {
      e.preventDefault();
      console.log("Submit button clicked");
      var pattern = $("#search").val();
      var replaced = pattern.split(' ').join('+');
      var url = build_imdb_search_url(replaced);
      console.log(url);

      $.getJSON(url, function(json) { 
        console.log(json);
        for (var i = 0; i < json.length; i++) {
         var row = $("<tr>");
          $(row).append("<td>" + json[i].title + "</td>");
          $(row).append("<td>" + json[i].year + "</td>");
          $(row).append("<td>" + json[i].genre + "</td>");
          $(row).append("<td>" + json[i].rating + "</td>");
          $(row).append("<td>" + json[i].description + "</td>");
          $(row).append("</tr>");
          $("#showList tbody").append(row);
        };
       });
    });
  });


  </script>
  </html>
